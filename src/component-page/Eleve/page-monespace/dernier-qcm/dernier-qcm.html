<div class="flex-1">
  <div class="ml-16 border-2 border-[#8002FF] p-6 bg-[#0A072E] text-white rounded-2xl shadow-2xl w-full">

    <h2 class="text-2xl sm:text-3xl md:text-3xl lg:text-4xl font-extrabold mb-6 text-[#8002FF] text-center sm:text-left">
      Mes derniers QCM
    </h2>

    <!-- Loading -->
    <div *ngIf="loading" class="text-gray-400 text-center py-6 animate-pulse text-base sm:text-lg">
      Chargement des QCM...
    </div>

    <!-- Aucun QCM -->
    <div *ngIf="!loading && derniersQcm.length === 0" class="text-white text-center py-6 text-base sm:text-lg">
      Vous n'avez encore fait aucun QCM.
    </div>

    <!-- Liste des 2 derniers QCM -->
    <div *ngIf="!loading && displayedQcm.length > 0" class="grid gap-4 sm:gap-6">
      <div *ngFor="let qcm of displayedQcm"
           class="p-4 sm:p-5 bg-gradient-to-r from-[#1A0C55]/80 to-[#3F0255]/80 border-l-4 border-[#8002FF] 
                  rounded-xl flex flex-col sm:flex-row justify-between items-start sm:items-center gap-3 sm:gap-4 
                  hover:scale-105 hover:shadow-xl transition-transform duration-300 cursor-pointer">

        <!-- Informations QCM -->
        <div class="flex-1">
          <h3 class="font-bold text-lg sm:text-xl md:text-2xl text-[#FFB6FF] truncate">{{ qcm.titre }}</h3>
          <p class="text-gray-300 text-sm sm:text-base mt-1">Fait le : {{ qcm.date | date:'medium' }}</p>
        </div>

        <!-- Score et XP -->
        <div class="flex flex-col sm:flex-row gap-2 sm:gap-4 mt-2 sm:mt-0">
          <span class="bg-gradient-to-r from-[#8002FF]/40 to-[#5A02FF]/40 px-3 sm:px-4 py-2 rounded-lg font-semibold text-sm sm:text-base text-white shadow-md">
            Score : {{ qcm.score }}
          </span>
          <span class="bg-gradient-to-r from-[#FF70FF]/40 to-[#FF3EFF]/40 px-3 sm:px-4 py-2 rounded-lg font-semibold text-sm sm:text-base text-white shadow-md">
            XP : {{ qcm.xpGagne }}
          </span>
        </div>

      </div>
    </div>

    <!-- Bouton pour voir tous les QCM -->
    <div *ngIf="derniersQcm.length > displayedQcm.length" class="text-center mt-4">
      <button (click)="togglePopup()" 
              class="bg-[#8002FF] hover:bg-[#5A02FF] px-6 py-2 rounded-xl font-bold text-white transition">
        Voir tous mes QCM
      </button>
    </div>

  </div>
</div>

<!-- Popup avec pagination -->
<div *ngIf="showPopup" class="fixed inset-0 bg-black/70 z-50 flex items-center justify-center p-4">
  <div class="bg-[#0A072E] rounded-2xl p-6 max-w-3xl w-full overflow-auto">
    <h3 class="text-xl font-bold text-[#FFB6FF] mb-4">Tous les QCM</h3>

    <div class="grid gap-4">
      <div *ngFor="let qcm of paginatedQcm"
           class="p-4 bg-gradient-to-r from-[#1A0C55]/80 to-[#3F0255]/80 border-l-4 border-[#8002FF] rounded-xl">
        <h4 class="font-semibold text-[#FFB6FF]">{{ qcm.titre }}</h4>
        <p class="text-gray-300 text-sm mt-1">Fait le : {{ qcm.date | date:'medium' }}</p>
        <div class="flex gap-2 mt-2">
          <span class="bg-gradient-to-r from-[#8002FF]/40 to-[#5A02FF]/40 px-3 py-1 rounded-lg font-semibold text-white text-sm shadow-md">
            Score : {{ qcm.score }}
          </span>
          <span class="bg-gradient-to-r from-[#FF70FF]/40 to-[#FF3EFF]/40 px-3 py-1 rounded-lg font-semibold text-white text-sm shadow-md">
            XP : {{ qcm.xpGagne }}
          </span>
        </div>
      </div>
    </div>

    <!-- Pagination -->
    <div class="flex justify-center mt-4 gap-2">
      <button *ngFor="let page of [].constructor(totalPages); let i = index"
              (click)="goToPage(i + 1)"
              [class.bg-[#8002FF]]="currentPage === i + 1"
              class="px-3 py-1 rounded-lg border border-[#8002FF] text-white font-bold hover:bg-[#5A02FF] transition">
        {{ i + 1 }}
      </button>
    </div>

    <div class="text-right mt-4">
      <button (click)="togglePopup()" class="bg-[#8002FF] hover:bg-[#5A02FF] px-4 py-2 rounded-lg text-white font-bold">
        Fermer
      </button>
    </div>
  </div>
</div>
