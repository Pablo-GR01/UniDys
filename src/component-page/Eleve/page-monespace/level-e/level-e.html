<div class="mt-4 mb-20 ml-4 min-h-[280px] pb-6 px-6 flex flex-col items-center justify-start rounded-2xl max-w-xs mx-auto
            bg-gradient-to-b from-[#3F0255] to-[#8002FF] border border-purple-600 shadow-xl
            transition-all duration-300 hover:scale-105">

  <ng-container *ngIf="!isLoading; else loadingTemplate">

    <!-- XP Header -->
    <div class="w-full flex flex-col items-center mb-3 pt-4">
      <h2 class="text-white text-2xl font-extrabold drop-shadow-md tracking-wide">
        {{ user?.xp }} XP
      </h2>
      <span class="px-4 py-1.5 rounded-full text-sm font-semibold text-purple-50 bg-gradient-to-r from-purple-600 to-purple-800 shadow mt-1">
        Level : {{ level }}
      </span>
    </div>

    <!-- Badge Niveau -->
    <div class="flex justify-center my-3">
      <div 
        [ngClass]="{
          'from-gray-400 to-gray-600': level <= 1,
          'from-blue-400 to-blue-700': level === 2,
          'from-yellow-300 to-yellow-500': level === 3,
          'from-orange-400 to-orange-600': level >= 4
        }"
        class="flex items-center justify-center w-20 h-20 rounded-xl shadow-xl text-white text-4xl font-extrabold relative
               before:absolute before:inset-0 before:rounded-xl before:bg-white/10 before:blur-xl before:animate-pulse
               transition-all duration-500">
        {{ level }}
      </div>
    </div>

    <!-- Progression -->
    <div class="w-full bg-gray-800/70 rounded-full h-4 overflow-hidden mb-3 shadow-inner">
      <div [style.width.%]="progression"
           class="h-4 rounded-full transition-all duration-700 ease-out"
           [ngStyle]="{'background': 'linear-gradient(to right, #ff5f6d, #ffc371)'}">
      </div>
    </div>

    <!-- Prochain objectif -->
    <p class="text-gray-200 text-xs mt-1 text-center">
      <span class="mr-1">ğŸš€</span>
      Il vous reste <strong>{{ xpRestant }}</strong> XP pour atteindre le Level <strong>{{ level + 1 }}</strong>
    </p>

  </ng-container>

  <ng-template #loadingTemplate>
    <div class="flex flex-col items-center pt-8">
      <div class="w-10 h-10 border-4 border-purple-500 border-t-transparent rounded-full mb-2 animate-spin"></div>
      <p class="text-purple-100 text-xs">Chargement des donnÃ©es...</p>
    </div>
  </ng-template>

  <ng-template #noUserTemplate>
    <p class="text-white text-sm pt-8">Aucun utilisateur connectÃ©.</p>
  </ng-template>

  <div *ngIf="errorMessage" class="text-red-400 mt-2 font-medium text-sm text-center">
    {{ errorMessage }}
  </div>

</div>
