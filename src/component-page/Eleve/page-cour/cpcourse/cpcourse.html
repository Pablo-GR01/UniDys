<div class="bg-[#0A092B] pt-2">
  <!-- Barre de recherche + filtres -->
  <div
    class="mt-10 flex flex-col md:flex-row md:items-center md:justify-between gap-4 bg-[#0A092B] border-2 border-[#8002FF] rounded px-4 py-3 w-full max-w-6xl mx-auto">
    <!-- Recherche -->
    <div class="flex items-center gap-2 w-full md:w-auto">
      <i class="fa-solid fa-magnifying-glass text-white"></i>
      <input type="text" [(ngModel)]="recherche" (ngModelChange)="filtrerCours()" placeholder="Recherche la matière"
        class="bg-transparent text-white focus:outline-none w-full">
    </div>

    <!-- Filtres par niveau -->
    <div class="flex flex-wrap gap-2 justify-start md:justify-center w-full md:w-auto">
      <button (click)="filtrerParNiveau('CP')"
        class="bg-[#8002FF] text-white px-3 py-1 rounded hover:bg-purple-700">CP</button>
      <button (click)="filtrerParNiveau('CE1')"
        class="bg-[#8002FF] text-white px-3 py-1 rounded hover:bg-purple-700">CE1</button>
      <button (click)="filtrerParNiveau('CE2')"
        class="bg-[#8002FF] text-white px-3 py-1 rounded hover:bg-purple-700">CE2</button>
      <button (click)="filtrerParNiveau('CM1')"
        class="bg-[#8002FF] text-white px-3 py-1 rounded hover:bg-purple-700">CM1</button>
      <button (click)="filtrerParNiveau('CM2')"
        class="bg-[#8002FF] text-white px-3 py-1 rounded hover:bg-purple-700">CM2</button>
      <button (click)="reinitialiserFiltre()"
        class="bg-gray-600 text-white px-3 py-1 rounded hover:bg-gray-700">Tous</button>
    </div>
  </div>

  <!-- Liste des cours ou message vide -->
  <div #track class="flex flex-wrap justify-center gap-6 mt-10 px-4 w-full max-w-7xl mx-auto pb-20">

    <!-- Si aucun cours -->
    @if(coursFiltres.length === 0){
    <div class="w-full text-center text-white text-lg font-semibold">
      Aucun cours disponible pour ce niveau.
    </div>
    }


    
<!-- Cartes de cours en grille -->
@for (cours of coursFiltres; track cours._id) {
  <div
    class="bg-[#020118] rounded-3xl p-5 shadow-md border border-purple-600 
           cursor-pointer flex-shrink-0 w-full sm:w-[47%] md:w-[30%] lg:w-[23%]
           transition-transform transform hover:scale-105 hover:shadow-purple-400/70
           duration-300">

    <!-- Image + badge niveau -->
    <div class="relative">
      <img [src]="getImageParMatiere(cours.matiere)" alt="{{ cours.matiere }}"
        class="w-full h-40 object-cover rounded-2xl border-2 border-purple-600 shadow-sm" />
      <div
        class="absolute top-2 left-2 bg-[#8002FF] text-xs px-2 py-0.5 rounded font-semibold text-white">
        {{ cours.niveau }}
      </div>
    </div>

    <!-- Infos cours -->
    <h3 class="text-md font-bold mt-3 mb-1 truncate text-white">{{ cours.titre }}</h3>
    <p class="text-xs text-white mb-1 truncate">
      <span class="font-semibold text-white">Matière :</span> {{ cours.matiere }}
    </p>
    <p class="text-xs mb-3">
      <span class="font-semibold text-white">QCM :</span>
      <span
        [ngClass]="(cours.qcms?.length ?? 0) > 0 ? 'text-green-400 font-semibold' : 'text-red-400 font-semibold'">
        {{ (cours.qcms?.length ?? 0) > 0 ? 'Oui' : 'Non' }}
      </span>
    </p>

    <!-- Actions principales -->
    <div class="flex flex-wrap gap-2 mt-2 justify-center">
      <!-- Lire sur YouTube -->
      @if (cours.lienYoutube) {
        <button (click)="ouvrirLienYoutube(cours.lienYoutube)"
          class="flex items-center gap-2 px-3 py-2 rounded-xl text-xs font-semibold text-white
                 bg-gradient-to-r from-[#8002FF] to-[#3F0255]
                 shadow-md hover:scale-105 hover:shadow-purple-400/70
                 transition transform duration-300">
          <i class="fa-solid fa-play"></i> Lire
        </button>
      }

      <!-- Voir le cours -->
      <a [routerLink]="['/coursdetailE', cours._id]"
        class="flex items-center gap-2 px-3 py-2 rounded-xl text-xs font-semibold text-white
               bg-gradient-to-r from-[#8002FF] to-[#3F0255]
               shadow-md hover:scale-105 hover:shadow-purple-400/70
               transition transform duration-300">
        <i class="fas fa-eye"></i> Voir
      </a>

      <!-- Télécharger PDF -->
      @if (cours.fichierPdf) {
        <button (click)="telechargerFichier(cours.fichierPdf)"
          class="flex items-center gap-2 px-3 py-2 rounded-xl text-xs font-semibold text-white
                 bg-gradient-to-r from-[#8002FF] to-[#3F0255]
                 shadow-md hover:scale-105 hover:shadow-purple-400/70
                 transition transform duration-300">
          <i class="fas fa-download"></i> Télécharger
        </button>
      }
    </div>
  </div>
}


  </div>

</div>