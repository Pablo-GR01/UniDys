<app-icon></app-icon>

<!-- Menu utilisateur -->
<div class="flex items-center gap-3 relative 2xl:-mr-45">

  <!-- Initiales ou icône admin -->
  <div
    class="absolute bg-violet-700 flex items-center justify-center rounded-full font-black text-white
           2xl:mt-0 2xl:-ml-15 2xl:w-12 2xl:h-12 2xl:text-xl
           md:-mt-7 md:ml-114 md:w-10 md:h-10 md:text-md">
    <ng-container *ngIf="userService.getUser()?.role === 'admin'; else initiales">
      <i class="fa-solid fa-crown text-white text-2xl"></i>
    </ng-container>
    <ng-template #initiales>
      {{ userService.getInitiales() }}
    </ng-template>
  </div>

  <!-- Mon Espace (desktop) -->
  <div class="hidden md:flex items-center gap-1 cursor-pointer" role="button" tabindex="0"
       aria-haspopup="true" [attr.aria-expanded]="menuOuvert" (click)="toggleMenu()">
    <a routerLink="/monespaceE"
       class="text-white font-black text-sm sm:text-lg xl:text-xl 2xl:text-2xl hover:text-[#8002FF]">
      Mon Espace
    </a>
    <svg class="w-4 h-4 sm:w-6 sm:h-6 transition-transform duration-300 text-white"
         [class.rotate-180]="menuOuvert"
         fill="none" stroke="currentColor" stroke-width="2"
         viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7" />
    </svg>
  </div>

  <!-- Menu hamburger (mobile) -->
  <button class="block md:hidden text-white focus:outline-none" (click)="toggleMobileMenu()">
    <svg class="w-6 h-6" fill="none" stroke="currentColor" stroke-width="2"
         viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round"
            d="M4 6h16M4 12h16M4 18h16"></path>
    </svg>
  </button>
</div>

<!-- Menu déroulant desktop -->
@if(menuOuvert && !mobileMenu) {
  <div class="absolute right-4 mt-2 bg-[#020118] border-2 border-[#8002FF] text-white rounded-xl shadow-md z-50
              w-48 sm:w-56 hidden md:block 2xl:-mr-50">
    <ul class="flex flex-col gap-1 py-2">
      <li class="px-4 py-2 hover:bg-[#8002FF] cursor-pointer rounded flex items-center gap-2">
        <i class="fa-solid fa-circle-info"></i>
        <a routerLink="/InfoE" class="block w-full text-sm sm:text-base">Informations</a>
      </li>
      <li class="px-4 py-2 hover:bg-[#8002FF] cursor-pointer rounded flex items-center gap-2">
        <i class="fa-solid fa-power-off"></i>
        <a routerLink="/connexion" class="block w-full text-sm sm:text-base">Déconnexion</a>
      </li>
    </ul>
  </div>
}

<!-- Menu mobile -->
@if(mobileMenu) {
  <div class="absolute top-14 right-4 bg-[#020118] border-2 border-[#8002FF] text-white rounded-xl shadow-md z-50 w-48">
    <ul class="flex flex-col gap-1 py-2">
      <li class="px-4 py-2 hover:bg-[#8002FF] cursor-pointer rounded">
        <a routerLink="/accueilE" class="block w-full text-sm">Accueil</a>
      </li>
      <li class="px-4 py-2 hover:bg-[#8002FF] cursor-pointer rounded">
        <a routerLink="/coursE" class="block w-full text-sm">Cours</a>
      </li>
      <li class="px-4 py-2 hover:bg-[#8002FF] cursor-pointer rounded">
        <a routerLink="/aproposE" class="block w-full text-sm">À propos</a>
      </li>
      <li class="px-4 py-2 hover:bg-[#8002FF] cursor-pointer rounded flex items-center gap-2">
        <i class="fa-solid fa-circle-info"></i>
        <a routerLink="/InfoE" class="block w-full text-sm">Informations</a>
      </li>
      <li class="px-4 py-2 hover:bg-[#8002FF] cursor-pointer rounded flex items-center gap-2">
        <i class="fa-solid fa-power-off"></i>
        <a routerLink="/connexion" class="block w-full text-sm">Déconnexion</a>
      </li>
    </ul>
  </div>
}
